{% extends "layouts/ukti.html" %}
{% import "macros/trade.html" as trade %}

{% block main %}
  <h1 class="page-heading">
    {% if formData.id %}
      Edit company
    {% else %}
      Create a company
    {% endif %}
  </h1>
  <div class="grid-row">
    <div class="column-three-quarters">
      {{ trade.errorPanel( errors, labels=companyDetailsLabels ) }}
      <div class="section">
        <div class="for-control key-value key-value--vertical">
          <div id="business-type" class="key-value__key form-label-bold">Business type
            <a href="/company/add-step-1" class="button-link">Change</a>
          </div>
          <div class="key-value__value" aria-labelledby="business-type">{{business_type.name}}</div>
        </div>
      </div>

      <form method="POST">
        <input type="hidden" name="_csrf_token" value="{{csrfToken}}">
        <input type="hidden" name="business_type" value="{{formData.business_type}}">
        <input type="hidden" name="uk_based" value="yes">
        <input type="hidden" name="id" value="{{formData.id}}">

        {{ trade.textbox("name", label="Name", value=formData.name, error=errors.name) }}

        {{ trade.textbox("alias", label="Trading name", value=formData.alias, error=errors.alias) }}

        <fieldset id="registered-address-wrapper" class="fieldset--address lookup-address-js">
          <div class="form-group"><legend class="form-label-bold">Primary address</legend></div>
          <div class="key-value key-value--vertical form-group">
            <div id="registered-address-contry-label" class="key-value__key form-label-bold">Country</div>
            <div class="key-value__value" aria-labelledby="registered-address-contry-label">United Kingdom</div>
          </div>

          <div class="form-group form-group--postcode">{# hide for none js #}
            <label class="form-label-bold">Postcode</label>
            <input class="form-control postcode-lookup-value postcode-lookup-field" autoComplete="off" value="">
            <button class="button button-secondary postcode-lookup-button" type="button">Find UK address</button>
          </div>
          {# dropdown of suggestions #}
          <div class="form-group form-group--address-suggestions">
            <label class="form-label-bold">Select an address from the drop down</label>
            <select class="form-control">
            <option value="">Please enter a postcode to lookup your address</option>
            </select>
          </div>

          {{ trade.textbox("registered_address_1", label="Business and street (optional)", value=formData.registered_address_1, error=errors.registered_address_1) }}
          {{ trade.textbox("registered_address_2", value=formData.registered_address_2, error=errors.registered_address_2) }}
          {{ trade.textbox("registered_address_town", label="Town or city (optional)", value=formData.registered_address_town, error=errors.registered_address_town) }}
          {{ trade.textbox("registered_address_county", label="County (optional)", value=formData.registered_address_county, error=errors.registered_address_county) }}
          {{ trade.textbox("registered_address_postcode", label="Postcode (optional)", value=formData.registered_address_postcode, error=errors.registered_address_postcode) }}
          <input type="hidden" name="registered_address_country" value="{{formData.registered_address_country}}">
        </fieldset>

        <div class="form-group">
          <div class="form-label-bold">Trading address (optional)</div>
          <button id="add-trading-address" class="button-link{%if showTradingAddress == true %}hidden{% endif %}" type="button">Add trading address</button>
          <button id="remove-trading-address" class="button-link{%if showTradingAddress == false %} hidden{% endif %}" type="button">Remove trading address</button>
        </div>

        <fieldset id="trading-address-wrapper"
          class="fieldset--address lookup-address-js{%if showTradingAddress == false %} hidden{% endif %}">
          <div class="key-value key-value--vertical form-group">
            <div id="trading-address-contry-label" class="key-value__key form-label-bold">Country</div>
            <div class="key-value__value" aria-labelledby="trading-address-contry-label">United Kingdom</div>
          </div>

          <div class="form-group form-group--postcode">{# hide for none js #}
            <label class="form-label-bold">Postcode</label>
            <input class="form-control postcode-lookup-value postcode-lookup-field" autoComplete="off" value="">
            <button class="button button-secondary postcode-lookup-button" type="button">Find UK address</button>
          </div>
          {# dropdown of suggestions #}
          <div class="form-group form-group--address-suggestions">
            <label class="form-label-bold">Select an address from the drop down</label>
            <select class="form-control">
            <option value="">Please enter a postcode to lookup your address</option>
            </select>
          </div>

          {{ trade.textbox("trading_address_1", label="Business and street (optional)", value=formData.trading_address_1, error=errors.trading_address_1) }}
          {{ trade.textbox("trading_address_2", value=formData.trading_address_2, error=errors.trading_address_2) }}
          {{ trade.textbox("trading_address_town", label="Town or city (optional)", value=formData.trading_address_town, error=errors.trading_address_town) }}
          {{ trade.textbox("trading_address_county", label="County (optional)", value=formData.trading_address_county, error=errors.trading_address_county) }}
          {{ trade.textbox("trading_address_postcode", label="Postcode (optional)", value=formData.trading_address_postcode, error=errors.trading_address_postcode) }}
          <input type="hidden" name="trading_address_country" value="{{formData.trading_address_country}}">
        </fieldset>

        {{ trade.dropdown("uk_region", label="UK region", emptyLabel="Pick a value", value=formData.uk_region, options=regionOptions, error=errors.uk_region) }}
        <fieldset class="form-group form-group__checkbox-group" id="headquarters-wrapper">
          <legend class="form-label-bold">Is this a headquarters?</legend>
          <label
            class="block-label selection-button-radio{% if not formData.headquarter_type or formData.headquarter_type == '' %} selected{% endif %}">
            <input name="headquarters" type="radio" value="" {% if not formData.headquarter_type or formData.headquarter_type == '' %} checked{% endif %}>
            Not a headquarters
          </label>
          {% for option in headquarterOptions %}
            <label class="block-label selection-button-radio {% if option.id == formData.headquarter_type %}selected{% endif %}">
              <input name="headquarters" type="radio" value="{{option.id}}" {% if option.id == formData.headquarter_type %}checked{% endif %}>
              {{ hqLabels[option.name] }}
            </label>
          {% endfor %}
        </fieldset>
        {{ trade.dropdown("sector", label="Sector", emptyLabel="Pick a value", value=formData.sector, options=sectorOptions, error=errors.sector) }}
        {{ trade.textbox("website", label="Website (optional)", value=formData.website, error=errors.website) }}
        {{ trade.textarea("description", label="Business description (optional)", value=formData.description, error=errors.description) }}
        {{ trade.dropdown("employee_range", label="Number of employees (optional)", emptyLabel="Pick a value", value=formData.employee_range, options=employeeOptions, error=errors.employee_range) }}
        {{ trade.dropdown("turnover_range", label="Annual turnover (optional)", emptyLabel="Pick a value", value=formData.turnover_range, options=turnoverOptions, error=errors.turnover_range) }}

        {% if formData.id %}
          {{ trade.save(backUrl=referer) }}
        {% else %}
          {{ trade.save(buttonText="Save and create", backUrl=referer) }}
        {% endif %}
      </form>
    </div>
  </div>
  <script src="/javascripts/companyedit.bundle.js"></script>
{% endblock %}
