{% extends "_layouts/search.njk" %}

{% block actions %}
  <div class="action-bar">
    <a class="button button-secondary" href="/company/add-step-1/">
      Add company
    </a>
  </div>
{% endblock %}

{% block search_results_summary %}
  {% component 'results-summary', {
    resultType: searchEntity,
    pluralisedResultType: 'companies',
    total: results.count,
    searchTerm: searchTerm
  } %}
{% endblock %}

{% block search_results %}
  <ol class="c-entity-list">
    {% for company in results.companies %}
      <li class="c-entity-list__item">

        {% if company.companies_house_data %}
          {% set companyUrl = '/companies/view/ch/' + company.companies_house_data.company_number %}
        {% else %}
          {% set companyUrl = '/viewcompanyresult/' + company.id %}
        {% endif %}

        <h3 class="c-entity-list__item-header">
          <a href="{{ companyUrl }}">
            {{ company.name | highlight(searchTerm) }}
          </a>
        </h3>

        <dl class="metadata-list">
          {% if company.companies_house_data %}
            <dt class="metadata-list__term u-visually-hidden">Companies House Number</dt>
            <dd class="metadata-list__value">{{ company.companies_house_data.company_number }}</dd>
          {% endif %}

          <dt class="metadata-list__term u-visually-hidden">Address</dt>
          <dd class="metadata-list__value">
            {{ addressFormatter( [
              company.registered_address_1,
              company.registered_address_2,
              company.registered_address_county,
              company.registered_address_town,
              company.registered_address_postcode
            ]) }}
          </dd>
        </dl>
      </li>
    {% endfor %}
  </ol>
{% endblock %}
