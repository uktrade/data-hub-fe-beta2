{% extends "../../../views/_layout.njk" %}

{% block main_grid_right_column %}
  <h2 class="heading-medium">Evidence</h2>
  <table class="table--striped">
    <tr>
      <th>
        Tags
      </th>
      <th>
        Comment
      </th>
      <th class="table--filename-truncate">
        Filename
      </th>
      <th>
        File State
      </th>
      <th>
        Edit
      </th>
    </tr>

    {% for item in evidence.results %}
      <tr>
        <td>
          {% for tag in item.tags %}
            <span class="c-badge c-badge--multi" data-id="{{ tag.id }}">{{ tag.name }}</span>
          {% endfor %}
        </td>
        <td>
          {{ item.comment }}
        </td>
        <td class="table--filename-truncate">
          <span class="trunacte-text" title="{{ item.original_filename }}"><em>{{ item.original_filename }}</em></span>
        </td>
        <td>
          {% if item.status == 'virus_scanned' %}
            {% if item.av_clean %}
              <a href="/investment-projects/{{ item.investment_project.id }}/evidence/{{ item.id }}/download">Download</a>
            {% else %}
              <span class="c-message--error">The file did not pass virus scanning</span>
            {% endif %}
          {% elif item.status == 'not_virus_scanned' %}
            <span>File not virus scanned</span>
          {% elif item.status == 'virus_scanning_scheduled' %}
            <span>Virus scanning scheduled</span>
          {% elif item.status == 'virus_scanning_in_progress' %}
            <span>File is being scanned</span>
          {% elif item.status == 'virus_scanning_failed' %}
            <span class="c-message--error">Virus scanning failed</span>
          {% else %}
            <span class="c-message--error">Virus scanning failed</span>
          {% endif %}
        </td>
        <td>
          <a href="/investment-projects/{{ item.investment_project.id }}/evidence/{{ item.id }}/delete">Delete</a>
        </td>
      </tr>
    {% endfor %}
  </table>

  <br>
  <a href="evidence/add-new" class="button">Add new evidence</a>
{% endblock %}
